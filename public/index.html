<!doctype html>
<html lang="vi" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Katalyst</title>
    <link rel="stylesheet" href="/styles.css" />
    <link rel="icon" type="image/png" href="/asset/Gemini_Generated_Image_xdmpsyxdmpsyxdmp.png" />
    <link rel="shortcut icon" type="image/png" href="/asset/Gemini_Generated_Image_xdmpsyxdmpsyxdmp.png" />
  </head>
  <body>
    <header class="app-header">
      <div class="brand">
        <div class="logo"><img src="/asset/Gemini_Generated_Image_xdmpsyxdmpsyxdmp.png" alt="Logo" /></div>
        <div>
          <h1>K-Talyst</h1>
          <p class="muted brand-subtitle">Qu·∫£n l√Ω c·∫•u h√¨nh, build, deploy v√† theo d√µi realtime.</p>
        </div>
      </div>
      <div class="header-actions">
        <button id="themeToggle" class="btn secondary">Ch·∫ø ƒë·ªô t·ªëi</button>
      </div>
    </header>
    <div class="layout">
      <!-- Sidebar Navigation -->
      <aside class="sidebar">
        <nav class="side-nav">
          <button class="tab-btn" data-tab="jobs-tab">üìã Qu·∫£n l√Ω Jobs</button>
          <button class="tab-btn" data-tab="queue-tab">‚è≥ H√†ng ƒë·ª£i Build</button>
          <button class="tab-btn" data-tab="builds-tab">üöÄ Qu·∫£n l√Ω Builds</button>
          <button class="tab-btn" data-tab="raw-config-tab">üìù config.json</button>
          <button class="tab-btn active" data-tab="config-tab">‚öôÔ∏è C·∫•u h√¨nh chung</button>
        </nav>
      </aside>

      <main class="container tab-container">
      <!-- Tab 1: C·∫•u h√¨nh chung -->
      <div id="config-tab" class="tab-content active">
        <!-- Git Configuration Section -->
        <section class="card">
          <h2>üîó C·∫•u h√¨nh Git Repository</h2>
          <div class="row">
            <div>
              <label for="provider">Nh√† cung c·∫•p</label>
              <select id="provider">
                <option value="gitlab">GitLab</option>
                <option value="github">GitHub</option>
              </select>
            </div>
            <div>
              <label for="polling">Chu k·ª≥ polling (gi√¢y)</label>
              <input id="polling" type="number" min="5" step="5" placeholder="30" />
            </div>
          </div>
          <div class="row">
            <div>
              <label for="account">T√†i kho·∫£n / T·ªï ch·ª©c</label>
              <input id="account" type="text" placeholder="vd: my-org" />
            </div>
            <div>
              <label for="token">Access Token</label>
              <input id="token" type="password" placeholder="ghp_/glpat_..." />
            </div>
          </div>
          <div class="row">
            <div>
              <label for="repoUrl">Repo URL</label>
              <input id="repoUrl" type="text" placeholder="https://gitlab.com/my-org/my-repo.git" />
            </div>
            <div>
              <label for="repoPath">Repo Path (m√°y ch·ªß ch·∫°y pull)</label>
              <input id="repoPath" type="text" placeholder="D:/repos/my-repo" />
            </div>
          </div>
          <div class="row">
            <div>
              <label for="branch">Branch</label>
              <input id="branch" type="text" placeholder="main" />
            </div>
          </div>
          <div class="row">
            <div>
              <label for="contextInitPath">ƒê∆∞·ªùng d·∫´n kh·ªüi t·∫°o Context</label>
              <input id="contextInitPath" type="text" placeholder="vd: D:/workspace" />
              <p class="muted">Khi l∆∞u c·∫•u h√¨nh, h·ªá th·ªëng s·∫Ω t·∫°o th∆∞ m·ª•c <strong>Katalyst</strong> t·∫°i ƒë∆∞·ªùng d·∫´n n√†y, bao g·ªìm <code>repo</code> v√† <code>builder</code>.</p>
            </div>
          </div>
          <div class="actions">
            <button id="saveCfg" class="btn">L∆∞u c·∫•u h√¨nh Git</button>
            <button id="checkConnection" class="btn outline">Ki·ªÉm tra k·∫øt n·ªëi</button>
          </div>
          <p id="cfgStatus" class="status"></p>
        </section>

        <!-- Email Configuration Section -->
        <section class="card">
          <h2>üìß C·∫•u h√¨nh Email th√¥ng b√°o</h2>
          <div class="row">
            <div>
              <label for="smtpHost">SMTP Host</label>
              <input id="smtpHost" type="text" placeholder="smtp.gmail.com" />
            </div>
            <div>
              <label for="smtpPort">SMTP Port</label>
              <input id="smtpPort" type="number" placeholder="587" />
            </div>
          </div>
          <div class="row">
            <div>
              <label for="emailUser">Email ng∆∞·ªùi g·ª≠i</label>
              <input id="emailUser" type="email" placeholder="ci-cd@company.com" />
            </div>
            <div>
              <label for="emailPassword">M·∫≠t kh·∫©u Email</label>
              <input id="emailPassword" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" />
            </div>
          </div>
          <div class="row">
            <div>
              <label for="notifyEmails">Email nh·∫≠n th√¥ng b√°o</label>
              <input id="notifyEmails" type="text" placeholder="dev1@company.com, dev2@company.com" />
              <p class="muted">Nh·∫≠p nhi·ªÅu email c√°ch nhau b·∫±ng d·∫•u ph·∫©y</p>
            </div>
          </div>
          <div class="check-inline">
            <input id="enableEmailNotify" class="switch" type="checkbox" />
            <span>B·∫≠t th√¥ng b√°o email khi build th√†nh c√¥ng/th·∫•t b·∫°i</span>
          </div>
          <div class="actions">
            <button id="saveEmailConfig" class="btn">L∆∞u c·∫•u h√¨nh Email</button>
            <button id="testEmail" class="btn outline">G·ª≠i email test</button>
          </div>
        </section>

        <!-- Security & Secrets Configuration Section -->
        <section class="card">
          <h2>üîê C·∫•u h√¨nh B·∫£o m·∫≠t & Secrets</h2>
          <div class="row">
            <div>
              <label for="webhookSecret">Webhook Secret</label>
              <input id="webhookSecret" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" />
              <p class="muted">Secret ƒë·ªÉ x√°c th·ª±c webhook t·ª´ Git provider</p>
            </div>
            <div>
              <label for="apiKey">API Key (cho external calls)</label>
              <input id="apiKey" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" />
              <p class="muted">Key ƒë·ªÉ b·∫£o v·ªá c√°c API endpoints</p>
            </div>
          </div>
          <div class="row">
            <div>
              <label for="encryptionKey">Encryption Key</label>
              <input id="encryptionKey" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" />
              <p class="muted">Key ƒë·ªÉ m√£ h√≥a d·ªØ li·ªáu nh·∫°y c·∫£m</p>
            </div>
          </div>
          <div class="actions">
            <button id="saveSecurityConfig" class="btn">L∆∞u c·∫•u h√¨nh B·∫£o m·∫≠t</button>
            <button id="generateKeys" class="btn outline">T·∫°o keys t·ª± ƒë·ªông</button>
          </div>
        </section>

        <!-- System Configuration Section -->
        <section class="card">
          <h2>‚öôÔ∏è C·∫•u h√¨nh H·ªá th·ªëng</h2>
          <div class="row">
            <div>
              <label for="maxConcurrentBuilds">S·ªë build ƒë·ªìng th·ªùi t·ªëi ƒëa</label>
              <input id="maxConcurrentBuilds" type="number" placeholder="1" min="1" max="10" />
              <p class="muted">Gi·ªõi h·∫°n s·ªë l∆∞·ª£ng build ch·∫°y c√πng l√∫c (khuy·∫øn ngh·ªã: 1 cho m√°y y·∫øu)</p>
            </div>
            <div>
              <label for="buildTimeout">Timeout build (ph√∫t)</label>
              <input id="buildTimeout" type="number" placeholder="30" min="5" max="120" />
              <p class="muted">Th·ªùi gian t·ªëi ƒëa cho m·ªôt l·∫ßn build</p>
            </div>
          </div>
          <div class="row">
            <div>
              <label for="logRetentionDays">L∆∞u tr·ªØ log (ng√†y)</label>
              <input id="logRetentionDays" type="number" placeholder="30" min="1" max="365" />
              <p class="muted">S·ªë ng√†y l∆∞u tr·ªØ log build</p>
            </div>
            <div>
              <label for="diskSpaceThreshold">Ng∆∞·ª°ng c·∫£nh b√°o ·ªï ƒëƒ©a (%)</label>
              <input id="diskSpaceThreshold" type="number" placeholder="80" min="50" max="95" />
              <p class="muted">C·∫£nh b√°o khi ·ªï ƒëƒ©a s·ª≠ d·ª•ng qu√° % n√†y</p>
            </div>
          </div>
          <div class="actions">
            <button id="saveSystemConfig" class="btn">L∆∞u c·∫•u h√¨nh H·ªá th·ªëng</button>
            <button id="resetToDefault" class="btn outline">Kh√¥i ph·ª•c m·∫∑c ƒë·ªãnh</button>
          </div>
        </section>
      </div>

      <!-- Tab 2: Build & Deploy (ƒë√£ lo·∫°i b·ªè theo y√™u c·∫ßu) -->

      <!-- Tab 3: Qu·∫£n l√Ω Jobs -->
      <div id="jobs-tab" class="tab-content">
        <!-- Jobs List Section -->
        <section class="card">
          <h2>üìã Danh s√°ch Jobs</h2>
          <div class="jobs-header">
            <div class="jobs-actions">
              <button id="createJobBtn" class="btn primary">‚ûï T·∫°o Job m·ªõi</button>
              <button id="refreshJobsBtn" class="btn outline">üîÑ L√†m m·ªõi</button>
            </div>
            <div class="jobs-search">
              <input type="text" id="jobSearch" placeholder="üîç T√¨m ki·∫øm jobs..." />
            </div>
          </div>
          
          <div class="jobs-table-container">
            <table class="jobs-table">
              <thead>
                <tr>
                  <th>T√™n Job</th>
                  <th>Tr·∫°ng th√°i</th>
                  <th>Ph∆∞∆°ng th·ª©c Build</th>
                  <th>Services</th>
                  <th>Build cu·ªëi</th>
                  <th>Thao t√°c</th>
                </tr>
              </thead>
              <tbody id="jobsTableBody">
                <!-- Jobs will be populated here -->
              </tbody>
            </table>
          </div>
        </section>

        <!-- Job Statistics Section -->
        <section class="card">
          <h2>üìä Th·ªëng k√™ Jobs</h2>
          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-number" id="totalJobs">0</div>
              <div class="stat-label">T·ªïng Jobs</div>
            </div>
            <div class="stat-card">
              <div class="stat-number" id="activeJobs">0</div>
              <div class="stat-label">Jobs ƒëang ho·∫°t ƒë·ªông</div>
            </div>
            <div class="stat-card">
              <div class="stat-number" id="totalBuilds">0</div>
              <div class="stat-label">T·ªïng l∆∞·ª£t build</div>
            </div>
            <div class="stat-card">
              <div class="stat-number" id="successfulBuilds">0</div>
              <div class="stat-label">Builds th√†nh c√¥ng</div>
            </div>
            <div class="stat-card">
              <div class="stat-number" id="failedBuilds">0</div>
              <div class="stat-label">Builds th·∫•t b·∫°i</div>
            </div>
          </div>
        </section>
      </div>

      <!-- Tab 3: H√†ng ƒë·ª£i Build -->
      <div id="queue-tab" class="tab-content">
        <!-- Queue Status Section -->
        <section class="card">
          <h2>‚è≥ Tr·∫°ng th√°i H√†ng ƒë·ª£i</h2>
          <div class="queue-controls">
            <button id="refreshQueueBtn" class="btn outline">üîÑ L√†m m·ªõi</button>
            <button id="toggleQueueBtn" class="btn primary">‚è∏Ô∏è T·∫°m d·ª´ng Queue</button>
            <button id="clearQueueBtn" class="btn danger">üóëÔ∏è X√≥a h√†ng ƒë·ª£i</button>
          </div>
          
          <!-- Queue Statistics -->
          <div class="queue-stats">
            <div class="stat-card">
              <div class="stat-number" id="queueLength">0</div>
              <div class="stat-label">ƒêang ch·ªù</div>
            </div>
            <div class="stat-card">
              <div class="stat-number" id="runningJobs">0</div>
              <div class="stat-label">ƒêang ch·∫°y</div>
            </div>
            <div class="stat-card">
              <div class="stat-number" id="completedJobs">0</div>
              <div class="stat-label">Ho√†n th√†nh</div>
            </div>
            <div class="stat-card">
              <div class="stat-number" id="failedJobs">0</div>
              <div class="stat-label">Th·∫•t b·∫°i</div>
            </div>
            <div class="stat-card">
              <div class="stat-number" id="avgExecutionTime">0ms</div>
              <div class="stat-label">Th·ªùi gian TB</div>
            </div>
          </div>
        </section>

        <!-- Queue Configuration -->
        <section class="card">
          <h2>‚öôÔ∏è C·∫•u h√¨nh Queue</h2>
          <div class="form-row">
            <div class="form-group">
              <label for="maxConcurrentJobs">S·ªë job ƒë·ªìng th·ªùi t·ªëi ƒëa:</label>
              <input type="number" id="maxConcurrentJobs" min="1" max="5" value="1" />
              <small>Khuy·∫øn ngh·ªã: 1-2 cho m√°y y·∫øu</small>
            </div>
            <div class="form-group">
              <label for="resourceThreshold">Ng∆∞·ª°ng t√†i nguy√™n (%):</label>
              <input type="number" id="resourceThreshold" min="50" max="95" value="70" />
              <small>D·ª´ng queue khi CPU/Memory > ng∆∞·ª°ng n√†y</small>
            </div>
          </div>
          <div class="actions">
            <button id="saveQueueConfig" class="btn primary">üíæ L∆∞u c·∫•u h√¨nh</button>
          </div>
        </section>

        <!-- Running Jobs -->
        <section class="card">
          <h2>üèÉ‚Äç‚ôÇÔ∏è Jobs ƒëang ch·∫°y</h2>
          <div class="running-jobs-list" id="runningJobsList">
            <div class="empty-state">Kh√¥ng c√≥ job n√†o ƒëang ch·∫°y</div>
          </div>
        </section>

        <!-- Queue List -->
        <section class="card">
          <h2>üìã H√†ng ƒë·ª£i</h2>
          <div class="queue-list" id="queueList">
            <div class="empty-state">H√†ng ƒë·ª£i tr·ªëng</div>
          </div>
        </section>

        <!-- Recent Jobs -->
        <section class="card">
          <h2>üìä Jobs g·∫ßn ƒë√¢y</h2>
          <div class="tabs-container">
            <div class="tab-buttons">
              <button class="tab-btn active" data-target="completed-jobs">Ho√†n th√†nh</button>
              <button class="tab-btn" data-target="failed-jobs">Th·∫•t b·∫°i</button>
            </div>
            <div id="completed-jobs" class="tab-content active">
              <div class="completed-jobs-list" id="completedJobsList">
                <div class="empty-state">Ch∆∞a c√≥ job n√†o ho√†n th√†nh</div>
              </div>
            </div>
            <div id="failed-jobs" class="tab-content">
              <div class="failed-jobs-list" id="failedJobsList">
                <div class="empty-state">Ch∆∞a c√≥ job n√†o th·∫•t b·∫°i</div>
              </div>
            </div>
          </div>
        </section>
      </div>

      <!-- Tab 4: Qu·∫£n l√Ω Builds -->
      <div id="builds-tab" class="tab-content">
        <!-- Build Actions Section -->
        <!-- <section class="card">
          <h2>üöÄ Thao t√°c Build</h2>
          <div class="build-actions-grid">
            <button id="startPull" class="action-card">
              <div class="action-icon">üì•</div>
              <div class="action-info">
                <h3>Pull Code</h3>
                <p>K√©o code m·ªõi nh·∫•t t·ª´ repository</p>
              </div>
            </button>
            <button id="runScriptBuild" class="action-card" style="display: none;">
              <div class="action-icon">üìú</div>
              <div class="action-info">
                <h3>Run Script</h3>
                <p>Ch·∫°y script build t√πy ch·ªânh</p>
              </div>
            </button>
            <button id="runDockerBuild" class="action-card">
              <div class="action-icon">üî®</div>
              <div class="action-info">
                <h3>Build & Push</h3>
                <p>Build image v√† push l√™n registry</p>
              </div>
            </button>
            <button id="checkPullBuild" class="action-card primary">
              <div class="action-icon">‚ö°</div>
              <div class="action-info">
                <h3>Manual Pipeline</h3>
                <p>Th·ª±c hi·ªán ngay: Check + Pull + Build</p>
              </div>
            </button>
          </div>
          <div class="build-status">
            <p class="muted">Commit ƒë√£ build g·∫ßn nh·∫•t: <span id="lastBuiltCommit" class="tag">(ch∆∞a c√≥)</span></p>
          </div>
        </section> -->

        <!-- Build History Section -->
        <section class="card full">
          <div class="card-header">
            <h2>üìä L·ªãch s·ª≠ Builds</h2>
            <div class="header-actions">
              <button id="refreshBuilds" class="btn small outline">üîÑ Refresh</button>
              <button id="clearBuildHistory" class="btn small secondary">üóëÔ∏è X√≥a l·ªãch s·ª≠</button>
            </div>
          </div>
          
          <div class="build-filters">
            <input type="text" id="buildSearch" placeholder="üîç T√¨m ki·∫øm builds..." />
            <select id="buildStatusFilter">
              <option value="">T·∫•t c·∫£ tr·∫°ng th√°i</option>
              <option value="success">Th√†nh c√¥ng</option>
              <option value="failed">Th·∫•t b·∫°i</option>
              <option value="running">ƒêang ch·∫°y</option>
            </select>
          </div>

          <div class="builds-table-container">
            <table class="builds-table">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Th·ªùi gian</th>
                  <th>Commit</th>
                  <th>Branch</th>
                  <th>Ph∆∞∆°ng th·ª©c</th>
                  <th>Tr·∫°ng th√°i</th>
                  <th>Th·ªùi l∆∞·ª£ng</th>
                  <th>H√†nh ƒë·ªông</th>
                </tr>
              </thead>
              <tbody id="buildsTableBody">
                <!-- Build rows will be populated here -->
              </tbody>
            </table>
          </div>
        </section>

        <!-- Real-time Logs Section -->
        <section class="card full" id="logsSection">
          <div class="card-header">
            <h2 id="logsTitle">üìã Logs Realtime</h2>
            <div class="log-toolbar">
              <button id="copyLogs" class="btn small outline">üìã Copy</button>
              <button id="clearLogs" class="btn small secondary">üóëÔ∏è Clear</button>
              <button id="toggleAutoScroll" class="btn small outline active">üìú Auto Scroll</button>
            </div>
          </div>
          <div id="logs" aria-live="polite" aria-atomic="false" class="logs"></div>
        </section>
      </div>

      <!-- Tab 5: Ch·ªânh s·ª≠a tr·ª±c ti·∫øp config.json -->
      <div id="raw-config-tab" class="tab-content">
        <section class="card full">
          <div class="card-header">
            <h2>üìù Ch·ªânh s·ª≠a tr·ª±c ti·∫øp config.json</h2>
            <div class="header-actions">
              <button id="reloadConfigJson" class="btn small outline">üîÑ T·∫£i l·∫°i</button>
              <button id="formatConfigJson" class="btn small outline">üßπ Format JSON</button>
              <button id="validateConfigJson" class="btn small outline">‚úÖ Validate</button>
              <button id="saveConfigJson" class="btn small">üíæ L∆∞u</button>
            </div>
          </div>
          <p class="muted">C·∫©n tr·ªçng: S·ª≠a sai c·∫•u tr√∫c JSON c√≥ th·ªÉ g√¢y l·ªói h·ªá th·ªëng. H√£y ki·ªÉm tra tr∆∞·ªõc khi l∆∞u.</p>
          <textarea id="configJsonEditor" rows="26" spellcheck="false" placeholder="{\n  \"provider\": \"gitlab\",\n  ...\n}"></textarea>
          <p id="configJsonStatus" class="status"></p>
        </section>

        <section class="card">
          <div class="card-header">
            <h2>üóÇ Phi√™n b·∫£n c·∫•u h√¨nh</h2>
            <div class="header-actions">
              <button id="loadConfigVersions" class="btn small outline">üì• T·∫£i danh s√°ch phi√™n b·∫£n</button>
            </div>
          </div>
          <div id="configVersionsContainer">
            <ul id="configVersionsList" style="list-style: none; padding-left: 0; margin: 0;">
              <!-- Danh s√°ch phi√™n b·∫£n s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y -->
            </ul>
          </div>
        </section>
      </div>
      </main>
    </div>
    
    <!-- Modal ch·ªânh s·ª≠a Build -->
    <div id="modalBackdrop" class="backdrop hidden"></div>
    <div id="modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="editTitle">
      <div class="modal-card">
        <div class="modal-header">
          <h3 id="editTitle">Ch·ªânh s·ª≠a Build</h3>
          <button id="editCancelTop" class="btn small secondary">ƒê√≥ng</button>
        </div>
        <div class="modal-body">
          <label for="editBuildName">T√™n build</label>
          <input id="editBuildName" type="text" />
          <label for="editBuildEnv">ENV (JSON)</label>
          <input id="editBuildEnv" type="text" placeholder='{"NODE_ENV":"production"}' />
          <label for="editBuildSteps">C√°c b∆∞·ªõc (m·ªói d√≤ng 1 l·ªánh)</label>
          <textarea id="editBuildSteps" placeholder="npm ci\nnpm run build\nnpm run test"></textarea>
        </div>
        <div class="modal-actions">
          <button id="editSave" class="btn">L∆∞u</button>
          <button id="editCancel" class="btn outline">H·ªßy</button>
        </div>
      </div>
    </div>

    <!-- Job Management Modal -->
    <div id="jobModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2 id="jobModalTitle">T·∫°o Job m·ªõi</h2>
          <button id="jobModalClose" class="modal-close">&times;</button>
        </div>
        <div class="modal-body">
          <!-- Basic Info -->
          <div class="form-section">
            <h3>üìù Th√¥ng tin c∆° b·∫£n</h3>
            <label for="jobName">T√™n Job *</label>
            <input id="jobName" type="text" placeholder="VD: Build Backend Services" required />
            
            <label for="jobDescription">M√¥ t·∫£</label>
            <textarea id="jobDescription" placeholder="M√¥ t·∫£ chi ti·∫øt v·ªÅ job n√†y..."></textarea>
            
            <div class="checkbox-group">
              <input type="checkbox" id="jobEnabled" checked />
              <label for="jobEnabled">K√≠ch ho·∫°t job</label>
            </div>
          </div>

          <!-- Git Configuration -->
          <div class="form-section">
            <h3>üîó C·∫•u h√¨nh Git</h3>
            <div class="row">
              <div>
                <label for="jobGitProvider">Provider</label>
                <select id="jobGitProvider">
                  <option value="gitlab">GitLab</option>
                  <option value="github">GitHub</option>
                </select>
              </div>
              <div>
                <label for="jobGitAccount">Account</label>
                <input id="jobGitAccount" type="text" placeholder="my-org" />
              </div>
            </div>
            
            <div class="row">
              <div>
                <label for="jobGitToken">Access Token *</label>
                <input id="jobGitToken" type="password" placeholder="ghp_/glpat_..." required />
              </div>
              <div>
                <label for="jobGitBranch">Branch *</label>
                <input id="jobGitBranch" type="text" placeholder="main" required />
              </div>
            </div>
            
            <label for="jobGitRepoUrl">Repository URL *</label>
            <input id="jobGitRepoUrl" type="text" placeholder="https://gitlab.com/my-org/my-repo.git" required />
            
            <!-- Local Repository Path ƒë√£ ƒë∆∞·ª£c lo·∫°i b·ªè: h·ªá th·ªëng s·∫Ω t·ª± ƒë·ªông pull v√†o Context/Katalyst/repo -->
          </div>

          <!-- Build Configuration -->
          <div class="form-section">
            <h3>üî® C·∫•u h√¨nh Build</h3>
            <div class="build-method-selector">
              <div class="method-option">
                <input type="radio" id="jobMethodScript" name="jobBuildMethod" value="script" />
                <label for="jobMethodScript">üìú Build theo Script</label>
              </div>
              <div class="method-option">
                <input type="radio" id="jobMethodDocker" name="jobBuildMethod" value="dockerfile" checked />
                <label for="jobMethodDocker">üê≥ Build theo Dockerfile</label>
              </div>
              <div class="method-option">
                <input type="radio" id="jobMethodJson" name="jobBuildMethod" value="jsonfile" />
                <label for="jobMethodJson">üì¶ Build theo JSON Pipeline</label>
              </div>
            </div>
            
            <!-- Use Common Config Button -->
            <div class="common-config-section">
              <button type="button" id="useCommonConfigBtn" class="use-common-config-btn">
                <span>‚öôÔ∏è S·ª≠ d·ª•ng c·∫•u h√¨nh chung</span>
              </button>
              <small class="muted">T·ª± ƒë·ªông ƒëi·ªÅn th√¥ng tin t·ª´ c·∫•u h√¨nh chung (Registry, Docker config)</small>
            </div>
            
            <div class="row">
              <div>
                <label for="jobBuildOrder">Th·ª© t·ª± Build</label>
                <select id="jobBuildOrder">
                  <option value="parallel">Song song (Parallel)</option>
                  <option value="sequential">Tu·∫ßn t·ª± (Sequential)</option>
                </select>
              </div>
            </div>

            <!-- Script Build Config -->
            <div id="jobScriptConfig" class="method-config" style="display: none;">
              <!-- Tr∆∞·ªùng ƒë∆∞·ªùng d·∫´n Script ƒë√£ lo·∫°i b·ªè: h·ªá th·ªëng s·∫Ω s·ª≠ d·ª•ng script m·∫∑c ƒë·ªãnh trong th∆∞ m·ª•c builder -->
              <div class="info-box">
                <small class="muted">Khi ch·ªçn ph∆∞∆°ng th·ª©c Script, h·ªá th·ªëng s·∫Ω t·∫°o th∆∞ m·ª•c: <code>Context/Katalyst/builder/(t√™n-job + job_id)</code>. Vui l√≤ng ƒë·∫∑t file script m·∫∑c ƒë·ªãnh <code>build.sh</code> trong th∆∞ m·ª•c n√†y.</small>
              </div>
              
              <!-- Script Docker Configuration -->
              <div class="row">
                <div>
                  <label for="jobScriptImageName">T√™n Image</label>
                  <input id="jobScriptImageName" type="text" placeholder="my-app" />
                </div>
              </div>
              
              <!-- Script Tag Configuration -->
              <div class="tag-config-section">
                <h4>üè∑Ô∏è C·∫•u H√¨nh Tag</h4>
                <div class="row">
                  <div>
                    <label for="jobScriptImageTagNumber">Ph·∫ßn s·ªë (c√≥ th·ªÉ t·ª± tƒÉng)</label>
                    <input id="jobScriptImageTagNumber" type="text" placeholder="1.0.0" />
                  </div>
                  <div>
                    <label for="jobScriptImageTagText">Ph·∫ßn ch·ªØ (c·ªë ƒë·ªãnh)</label>
                    <input id="jobScriptImageTagText" type="text" placeholder="BETA" />
                  </div>
                </div>
                
                <div class="row">
                  <div>
                    <input type="checkbox" id="jobScriptAutoTagIncrement" />
                    <label for="jobScriptAutoTagIncrement">T·ª± ƒë·ªông tƒÉng ph·∫ßn s·ªë sau m·ªói l·∫ßn build</label>
                  </div>
                </div>
                
                <div class="tag-preview">
                  <small class="muted">Tag cu·ªëi c√πng: <span id="jobScriptTagPreview">1.0.0-BETA</span></small>
                </div>
              </div>
              
              <!-- Script Registry Configuration -->
              <div class="row">
                <div>
                  <label for="jobScriptRegistryUrl">Registry URL</label>
                  <input id="jobScriptRegistryUrl" type="text" placeholder="https://registry.hub.docker.com" />
                </div>
              </div>
              
              <div class="row">
                <div>
                  <label for="jobScriptRegistryUsername">Registry Username</label>
                  <input id="jobScriptRegistryUsername" type="text" placeholder="username" />
                </div>
                <div>
                  <label for="jobScriptRegistryPassword">Registry Password</label>
                  <input id="jobScriptRegistryPassword" type="password" placeholder="password" />
                </div>
              </div>
            </div>

            <!-- Docker Build Config -->
            <div id="jobDockerConfig" class="method-config">
              <div class="row">
                <div>
                  <label for="jobDockerfilePath">Dockerfile Path</label>
                  <input id="jobDockerfilePath" type="text" placeholder="(ƒë·ªÉ tr·ªëng ƒë·ªÉ d√πng Dockerfile m·∫∑c ƒë·ªãnh trong repo)" />
                </div>
                <div>
                  <label for="jobContextPath">Context Path</label>
                  <input id="jobContextPath" type="text" placeholder="(ƒë·ªÉ tr·ªëng ƒë·ªÉ d√πng Context/Katalyst/repo)" />
                </div>
              </div>
              <small class="muted">N·∫øu ƒë·ªÉ tr·ªëng, h·ªá th·ªëng s·∫Ω t·ª± ƒë·ªông pull repo v√†o Context/Katalyst/repo v√† d√πng Dockerfile m·∫∑c ƒë·ªãnh t·∫°i th∆∞ m·ª•c g·ªëc c·ªßa repo khi build.</small>
              
              <div class="row">
                <div>
                  <label for="jobImageName">Image Name *</label>
                  <input id="jobImageName" type="text" placeholder="my-app" />
                </div>
              </div>
              
              <!-- Advanced Tag Configuration -->
              <div class="tag-config-section">
                <h4>üè∑Ô∏è C·∫•u h√¨nh Tag chi ti·∫øt</h4>
                <div class="row">
                  <div>
                    <label for="jobImageTagNumber">Ph·∫ßn s·ªë (c√≥ th·ªÉ t·ª± tƒÉng)</label>
                    <input id="jobImageTagNumber" type="text" placeholder="1.0.75" />
                  </div>
                  <div>
                    <label for="jobImageTagText">Ph·∫ßn ch·ªØ (c·ªë ƒë·ªãnh)</label>
                    <input id="jobImageTagText" type="text" placeholder="BETA" />
                  </div>
                </div>
                
                <div class="checkbox-group">
                  <input type="checkbox" id="jobAutoTagIncrement" />
                  <label for="jobAutoTagIncrement">T·ª± ƒë·ªông tƒÉng ph·∫ßn s·ªë sau m·ªói l·∫ßn build</label>
                </div>
                
                <div class="tag-preview">
                  <small class="muted">Tag cu·ªëi c√πng: <span id="jobTagPreview">1.0.75-BETA</span></small>
                </div>
              </div>
              
              <div class="row">
                <div>
                  <label for="jobRegistryUrl">Registry URL</label>
                  <input id="jobRegistryUrl" type="text" placeholder="harbor.example.com" />
                </div>
                <div>
                  <label for="jobRegistryUsername">Registry Username</label>
                  <input id="jobRegistryUsername" type="text" />
                </div>
              </div>
              
              <label for="jobRegistryPassword">Registry Password</label>
              <input id="jobRegistryPassword" type="password" />
            </div>

            <!-- JSON Pipeline Config -->
            <div id="jobJsonConfig" class="method-config" style="display: none;">
              <div class="info-box">
                <small class="muted">Nh·∫≠p ƒë∆∞·ªùng d·∫´n file JSON pipeline. H·ªá th·ªëng s·∫Ω th·ª±c thi c√°c b∆∞·ªõc theo file, b·ªè qua clone/pull repo m·∫∑c ƒë·ªãnh.</small>
              </div>
              <div class="row">
                <div>
                  <label for="jobJsonPipelinePath">Pipeline JSON File Path *</label>
                  <input id="jobJsonPipelinePath" type="text" placeholder="/home/katalyst/pipelines/initial-build.json" />
                </div>
              </div>
              <small class="muted">JSON h·ªó tr·ª£: pipeline_name, version, working_directory, environment_vars, steps (step_exec, timeout_seconds, on_fail/ignore_failure, shell).</small>
            </div>
          </div>

          <!-- Services Selection -->
          <div id="servicesSection" class="form-section">
            <h3>‚öôÔ∏è Ch·ªçn Services</h3>
            <div class="services-selection">
              <div class="services-header">
                <button type="button" id="selectAllServices" class="btn outline small">Ch·ªçn t·∫•t c·∫£</button>
                <button type="button" id="deselectAllServices" class="btn outline small">B·ªè ch·ªçn t·∫•t c·∫£</button>
              </div>
              <div id="servicesCheckboxes" class="services-checkboxes">
                <!-- Services will be populated here -->
              </div>
            </div>
          </div>

          <!-- Schedule Configuration -->
          <div class="form-section">
            <h3>‚è∞ C·∫•u h√¨nh L·ªãch tr√¨nh</h3>
            <div class="checkbox-group">
              <input type="checkbox" id="jobAutoCheck" />
              <label for="jobAutoCheck">T·ª± ƒë·ªông ki·ªÉm tra commit m·ªõi</label>
            </div>
            
            <div id="scheduleConfig" style="display: none;">
              <div class="row">
                <div>
                  <label for="jobPolling">Chu k·ª≥ ki·ªÉm tra (gi√¢y)</label>
                  <input id="jobPolling" type="number" value="30" min="10" />
                </div>
                <div>
                  <label for="jobCron">Cron Expression (t√πy ch·ªçn)</label>
                  <input id="jobCron" type="text" placeholder="0 */2 * * *" />
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <div class="modal-actions">
          <button id="saveJob" class="btn primary">üíæ L∆∞u Job</button>
          <button id="cancelJob" class="btn outline">‚ùå H·ªßy</button>
        </div>
      </div>
    </div>

    <!-- Refactored modular frontend -->
    <script type="module" src="/js/app.js"></script>
  </body>
  </html>