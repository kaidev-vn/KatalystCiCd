version: '3.8'
services:
  PARAM_DOCKER_SERVICE_NAME: # Tên Service sẽ được thay thế bởi script
    image: harbor.techres.vn/daihy/PARAM_DOCKER_IMAGE_NAME:PARAM_DOCKER_IMAGE_TAG
    
    # EXPOSE CẢ CỔNG API VÀ CỔNG GRPC RA HOST NODE (THEO YÊU CẦU CỦA BẠN)
    ports:
      - "PARAM_DOCKER_IMAGE_PORT:PARAM_DOCKER_IMAGE_PORT"
      - "PARAM_DOCKER_IMAGE_GRPC_PORT:PARAM_DOCKER_IMAGE_GRPC_PORT" # Đã thêm lại cổng GRPC
    
    # Network nội bộ cho giao tiếp GRPC và Load Balancing
    networks:
      - techres_overlay # Đặt tên network nội bộ

    # ----------------------------------------------------
    # HEALTHCHECK BLOCK (Cùng cấp với 'deploy')
    # ----------------------------------------------------
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:PARAM_HEALTH_CHECK_PORT/api/public/health-check"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 100s # THỜI GIAN CHỜ CHO SPRING BOOT KHỞI ĐỘNG
    
    # ----------------------------------------------------
    # DEPLOY BLOCK (Cấu hình Swarm và Zero Downtime)
    # ----------------------------------------------------
    deploy:
      replicas: 2 # Bắt buộc có >= 2 cho Zero Downtime
      placement:
        constraints:
          - PARAM_DOCKER_SWARM_NODE_CONSTRAINTS
      update_config:
        parallelism: 1       # Cập nhật từng container một
        delay: 10s           # Đợi 10s giữa các lần cập nhật
        order: start-first   # Khởi động container mới, đợi Healthy, rồi mới tắt container cũ
      restart_policy:
        condition: on-failure
      
      # RESOURCES BLOCK (Nằm TRONG deploy)
      resources:
        limits:
          cpus: '2'          # Giới hạn tối đa 2 core CPU
          memory: 2GB        # Giới hạn tối đa 2GB RAM
        reservations:
          cpus: '0.5'        # Đảm bảo tối thiểu 0.5 core CPU
          memory: 1GB        # Đảm bảo tối thiểu 1GB RAM

    # ----------------------------------------------------
    # CÁC CẤU HÌNH KHÁC
    # ----------------------------------------------------
    build:
      context: .
      dockerfile: ./Dockerfile
    volumes:
      - /opt/techres/logs:/techres/logs
      
    # ENVIRONMENT VARIABLES (Đã sửa lỗi trùng lặp)
    environment:
      - PROJECT_ENVIRONMENT=beta
      - PROJECT_TECHRES_ADMIN_API_PORT=PARAM_DOCKER_IMAGE_PORT
      - PROJECT_TECHRES_ORDER_API_PORT=PARAM_DOCKER_IMAGE_PORT
      - PROJECT_TECHRES_ORDER_LEVEL_ONE_API_PORT=PARAM_DOCKER_IMAGE_PORT
      - PROJECT_TECHRES_TMS_API_PORT=PARAM_DOCKER_IMAGE_PORT
      - PROJECT_TECHRES_SUPPLIER_API_PORT=PARAM_DOCKER_IMAGE_PORT
      - PROJECT_TECHRES_OAUTH_PORT=PARAM_DOCKER_IMAGE_PORT
      - PROJECT_TECHRES_SCHEDULE_PORT=PARAM_DOCKER_IMAGE_PORT
      - PROJECT_TECHRES_ADMIN_SCHEDULE_PORT=PARAM_DOCKER_IMAGE_PORT
      - PROJECT_ALOLINE_API_PORT=PARAM_DOCKER_IMAGE_PORT
      - PROJECT_TECHRES_RESTAURANT_DASHBOARD_API_PORT=PARAM_DOCKER_IMAGE_PORT
      - PROJECT_TECHRES_KAFKA_RESTAURANT_SCHEDULE_PORT=PARAM_DOCKER_IMAGE_PORT
      - PROJECT_TECHRES_KAFKA_TECHRES_ADMIN_SCHEDULE_PORT=PARAM_DOCKER_IMAGE_PORT
      - PROJECT_TECHRES_SPRINGDOC_PORT=PARAM_DOCKER_IMAGE_PORT
      - GRPC_SERVER_PORT=PARAM_DOCKER_IMAGE_GRPC_PORT
      - GRPC_CLIENT_NESTJS_ALOLINE_SYNC_ADDRESS=static://172.16.10.123:6022
      - GRPC_CLIENT_NESTJS_CUSTOMER_TOPIC_ADDRESS=static://172.16.10.123:2402
      - GRPC_CLIENT_NESTJS_CUSTOMER_GIFT_ADDRESS=static://172.16.10.123:2403
      - GRPC_CLIENT_JAVA_GRPC_RESTAURANT_SCHEDULE=static://172.16.10.201:1052
      - GRPC_CLIENT_NESTJS_INVENTORY_REPORT_ADDRESS=static://172.16.10.123:1062
      - GRPC_CLIENT_NESTJS_RESTAURANT_DATA_CHECK_ADDRESS=static://172.16.10.123:1080
      - GRPC_CLIENT_NESTJS_TECHRES_CONNECTION_ADDRESS=static://172.16.10.123:1068
      - GRPC_CLIENT_JAVA_CUSTOMER_ORDEREQUEST_ADDRESS=static://172.16.10.123:8501
      - GRPC_CLIENT_NESTJS_RESTAURANT_PAYMENT_ADDRESS=static://172.16.10.123:2412
      - GRPC_CLIENT_NODEJS_DAIHY_DEVICE_ADDRESS=static://172.16.10.123:1078
      - GRPC_CLIENT_JAVA_KPI_ADDRESS=static://172.16.10.123:1057
      - GRPC_CLIENT_JAVA_ELASTICSEARCH_ADDRESS=static://172.16.10.123:1056
      - GRPC_CLIENT_JAVA_FANOUT_SYNC_ADDRESS=static://172.16.10.201:9008
      - GRPC_CLIENT_NODEJS_CHANNEL_ORDER_FOOD_ADDRESS=static://172.16.10.123:2422
      - GRPC_CLIENT_JAVA_CUSTOMER_ORDER_ONLINE_ADDRESS=static://172.16.10.123:8503
      - GRPC_CLIENT_NESTJS_DEVICE_MANAGEMENT_ADDRESS=static://172.16.10.123:2402
      - GRPC_CLIENT_NESTJS_THIRD_PARTY_DELIVERY_ADDRESS=static://localhost:9000
      - GRPC_CLIENT_NODEJS_ALOLINE_MESSAGE_ADDRESS=static://172.16.10.71:2419
      - GRPC_CLIENT_NODEJS_TECHRES_PARTNER_ADDRESS=static://172.16.10.144:2420
      - GRPC_CLIENT_NODEJS_ALOLINE_BEER_GIFT_ADDRESS=static://172.16.10.71:2421
      - GRPC_CLIENT_NESTJS_ALOLINE_BEER_GIFT_ADDRESS=static://172.16.10.123:2403
      - GRPC_CLIENT_NESTJS_ZNS_CAMPAIGN_ADDRESS=static://172.16.10.123:2424
      - GRPC_CLIENT_NESTJS_SYSTEM_DEVICE_ADDRESS=static://172.16.10.123:2402
      - GRPC_CLIENT_NESTJS_DAIHY_CRM_CUSTOMER=static://172.16.10.123:1079
      - GRPC_CLIENT_NESTJS_DAIHY_ASSET_MANAGEMENT=static://172.16.10.218:30177
      - GRPC_CLIENT_NESTJS_SYSTEM_DEVICE_ADDRESS=static://172.16.10.74:2402
      - GRPC_CLIENT_NESTJS_DAIHY_CRM_CUSTOMER=static://172.16.10.218:30192
      - SOCKET_IO_REALTIME_URL=https://beta.realtime.order.daihy.ohqsoft.com/
      - SOCKET_IO_LOGIN_RESTAURANT_PARTNER_INVOICE_URL=http://172.16.10.123:1401/api/v2/invoices/check-account-partner
      - SOCKET_IO_UPLOAD_SHORT_URL=https://beta.api.gateway.daihy.ohqsoft.com/short/
      - SOCKET_IO_CONNECTION_URL=https://beta.realtime.chat.daihy.ohqsoft.com
      - SOCKET_IO_REGISTER_USER_URL=http://172.16.10.99:9005/api/v1/user/register
      - SOCKET_IO_REALTIME_LOCAL_IP=https://beta.realtime.chat.daihy.ohqsoft.com
      - SOCKET_IO_API_JOIN_GROUP_URL=https://beta.aloline.vn/g/
      - SOCKET_IO_CONECT_LOGIN=https://beta.realtime.oauth.techres.vn
      - SOCKET_IO_CHAT_ALOLINE_URL=http://172.16.2.245:1485
      - SOCKET_IO_OAUTH_URL=http://172.16.2.245:1485
      - SOCKET_IO_REALTIME_CHAT_SEEMT_URL=https://beta.realtime.chat.daihy.ohqsoft.com
      - SOCKET_IO_REALTIME_CHAT_SEEMT_URL_LOCAL=https://beta.realtime.chat.daihy.ohqsoft.com
      - SPRING_DATASOURCE_DRIVER_CLASSNAME=org.mariadb.jdbc.Driver
      - CONFIG_MYSQL_URL=jdbc:mariadb://172.16.10.196:3306/daihy_beta?characterEncoding=UTF-8\&useLegacyDatetimeCode=false\&zeroDateTimeBehavior=CONVERT_TO_NULL\&serverTimezone=Asia/Bangkok
      - CONFIG_MYSQL_USERNAME=daihy_beta
      - CONFIG_MYSQL_PASSWORD=daihy_beta
      - CONFIG_MYSQL_SLAVE_URL=jdbc:mariadb://172.16.10.196:3306/daihy_beta?characterEncoding=UTF-8\&useLegacyDatetimeCode=false\&zeroDateTimeBehavior=CONVERT_TO_NULL\&serverTimezone=Asia/Bangkok
      - CONFIG_MONGODB_URI=mongodb://admin:adminmongo_staging%40aloapp.vn@172.16.10.199:27017/staging_chat_mongo_db?authSource=admin
      - VIETQR_RESTAURANT_BRAND_BANK_ACCOUNT_BANK_LIST_URL=https://api.vietqr.io/v2/banks
      - VIETQR_RESTAURANT_BRAND_BANK_ACCOUNT_LOOKUP_URL=https://api.vietqr.io/v2/lookup
      - VIETQR_RESTAURANT_BRAND_BANK_ACCOUNT_CLIENT_ID=7e3601e6-8883-4a4d-bf1a-cbcf5b62af7d
      - VIETQR_RESTAURANT_BRAND_BANK_ACCOUNT_API_KEY=477f94bc-63f6-4d57-a12c-8a4a8ed602ca
      - HIBERNATE_DIALECT=org.hibernate.dialect.MySQLDialect
      - HIBERNATE_SHOW_SQL=false
      - HIBERNATE_FORMAT_SQL=true
      - HIKARICP_CACHEPREPSTMTS=true
      - HIKARICP_CACHESERVERCONFIGURATION=true
      - HIKARICP_PREPSTMTCACHESIZE=250
      - HIKARICP_PREPSTMTCACHESQLLIMIT=2048
      - HIKARICP_USESERVERPREPSTMTS=true
      - HIKARICP_USELOCALSESSIONSTATE=true
      - HIKARICP_REWRITEBATCHEDSTATEMENTS=true
      - HIKARICP_ELIDESETAUTOCOMMIT=true
      - HIKARICP_MAINTAINTIMESTATS=false
      - HIKARICP_USEUNBUFFEREDIO=false
      - HIKARICP_USEREADAHEADINPUT=false
      - HIKARICP_CACHERESULTSETMETADATA=true
      - HIKARICP_CONNECTIONTIMEOUT=30000
      - HIKARICP_IDLETIMEOUT=600000
      - HIKARICP_MAXLIFETIME=1800000
      - HIKARICP_MAXIMUM_POOL_SIZE=20
      - HIKARICP_MINIMUM_IDLE=5
      - LOGGING_LEVEL_ROOT=ERROR
      - LOGGING_LEVEL_ORG_HIBERNATE=ERROR
      - LOGGING_LEVEL_NET_TECHRES_SCHEDULE=INFO
      - LOGGING_LEVEL_NET_TECHRES_OAUTH=INFO
      - LOGGING_LEVEL_NET_TECHRES_ADMIN_API=INFO
      - LOGGING_LEVEL_NET_TECHRES_ORDER_API=INFO
      - LOGGING_LEVEL_NET_TECHRES_TMS_API=INFO
      - LOGGING_LEVEL_NET_TECHRES_SUPPLIER_API=INFO
      - LOGGING_LEVEL_NET_TECHRES_PARTY_API=INFO
      - LOGGING_LEVEL_COM_ZAXXER_HIKARI_HIKARICONFIG=ERROR
      - LOGGING_LEVEL_COM_ZAXXER_HIKARI=INFO
      - LOGGING_FILE_NAME=PARAM_DOCKER_IMAGE_NAME.log
      - SECURITY_OAUTH2_ENDPOINT=http://localhost:PARAM_DOCKER_IMAGE_PORT/oauth/token
      - SECURITY_SIGNING_KEY=bmVlZGlpc2VjcmV0
      - SECURITY_ENCODING_STRENGTH=256
      - SECURITY_SECURITY_REALM=Spring Boot JWT Realm
      - SECURITY_ACCESS_TOKEN_VALID_IN_SECONDS=15552000
      - SECURITY_JWT_CLIENT_ID=techres_clientid
      - SECURITY_JWT_CLIENT_SECRET=5a0d191cc1d656065e8410626f4f389e9cb1467d8b847b1d0b7e37283ed46643
      - SECURITY_JWT_GRANT_TYPE=password
      - SECURITY_JWT_SCOPE_READ=read
      - SECURITY_JWT_SCOPE_WRITE=write
      - SECURITY_JWT_RESOURCE_IDS=techresapi
      - SECRET_TOKEN=5a0d191cc1d656065e8410626f4f389e9cb1467d8b847b1d0b7e37283ed46643
      - SPRING_PROFILES_ACTIVE=cache.disable
      - SPRING_CACHE_TYPE=redis
      - SPRING_REDIS_HOST=172.16.10.199
      - SPRING_REDIS_PORT=6379
      - SPRING_REDIS_PASSWORD=fSjV8392zcatnCxRPRo7
      - SPRING_REDIS_OAUTH_HOST=172.16.10.199
      - SPRING_REDIS_OAUTH_PORT=6379
      - SPRING_REDIS_OAUTH_PASSWORD=fSjV8392zcatnCxRPRo7
      - SPRING_REDIS_CACHE_HOST=172.16.10.199
      - SPRING_REDIS_CACHE_PORT=6379
      - SPRING_REDIS_CACHE_PASSWORD=fSjV8392zcatnCxRPRo7
      - BUCKET4J_IS_ENABLE_LIMIT_RATE=TRUE
      - BUCKET4J_REDIS_CONNECTION_URL=redis://172.16.10.199:6379
      - BUCKET4J_REDIS_CONNECTION_PASSWORD=fSjV8392zcatnCxRPRo7
      - BUCKET4J_REQUEST_LIMIT_RATE=120
      - BUCKET4J_REQUEST_WINDOW_DURATION_IN_SECOND=60
      - KAFKA_BOOTSTRAP_SERVER_CONFIG=172.16.10.191:9092
      - KAFKA_TOPIC_OTP=kafka-topic-otp
      - KAFKA_TOPIC_ADMIN_SYNC=kafka.topic.admin-sync
      - KAFKA_TOPIC_SUPPLIER_SYNC=kafka.topic.supplier-sync
      - KAFKA_TOPIC_CUSTOMER_SYNC=kafka.topic.customer-sync
      - KAFKA_TOPIC_EMPLOYEE_SYNC=kafka.topic.employee-sync
      - KAFKA_TOPIC_RESTAURANT_ACTIVITY_LOG=kafka.topic.restaurant-activity-log
      - KAFKA_TOPIC_DAIHY_ACTIVITY_LOG=kafka.topic.daihy-activity-log
      - KAFKA_TOPIC_EMPLOYEE_NOTIFY_HANDLER=kafka.topic.employee-notify-handler
      - KAFKA_TOPIC_CUSTOMER_NOTIFY_HANDLER=kafka.topic.customer-notify-handler
      - KAFKA_TOPIC_SUPPLIER_NOTIFY_HANDLER=kafka.topic.supplier-notify-handler
      - KAFKA_TOPIC_CUSTOMER_REGISTER_PUSH_TOKEN_SYNC=kafka.topic.customer-register-push-token-sync
      - KAFKA_TOPIC_CUSTOMER_LOGOUT_PUSH_TOKEN_SYNC=kafka.topic.customer-logout-push-token-sync
      - KAFKA_TOPIC_EMPLOYEE_ORDER_REGISTER_PUSH_TOKEN_SYNC=kafka.topic.employee-order-register-push-token-sync
      - KAFKA_TOPIC_EMPLOYEE_ORDER_LOGOUT_PUSH_TOKEN_SYNC=kafka.topic.employee-order-logout-push-token-sync
      - KAFKA_TOPIC_EMPLOYEE_TMS_REGISTER_PUSH_TOKEN_SYNC=kafka.topic.employee-TMS-register-push-token-sync
      - KAFKA_TOPIC_EMPLOYEE_TMS_LOGOUT_PUSH_TOKEN_SYNC=kafka.topic.employee-TMS-logout-push-token-sync
      - KAFKA_TOPIC_EMPLOYEE_SUPPLIER_REGISTER_PUSH_TOKEN_SYNC=kafka.topic.employee-supplier-register-push-token-sync
      - KAFKA_TOPIC_EMPLOYEE_SUPPLIER_LOGOUT_PUSH_TOKEN_SYNC=kafka.topic.employee-supplier-logout-push-token-sync
      - KAFKA_TOPIC_ADMIN_REGISTER_PUSH_TOKEN_SYNC=kafka.topic.admin-register-push-token-sync
      - KAFKA_TOPIC_ADMIN_LOGOUT_PUSH_TOKEN_SYNC=kafka.topic.admin-logout-push-token-sync
      - KAFKA_TOPIC_EMPLOYEE_REGISTER_DEVICE=kafka.topic.employee-register-device
      - KAFKA_TOPIC_CUSTOMER_REGISTER_DEVICE=kafka.topic.customer-register-device
      - KAFKA_TOPIC_SUPPLIER_REGISTER_DEVICE=kafka.topic.supplier-register-device
      - KAFKA_TOPIC_NOTIFY_TOPIC_HANDLER=kafka.topic.notify-topic-handler
      - KAFKA_TOPIC_CUSTOMER_ALOLINE_PROFILE_SYNC=kafka.topic.customer-aloline-profile-sync
      - KAFKA_TOPIC_FCM_EMPLOYEE_NOTIFY=kafka.topic.fcm-employee-notify
      - KAFKA_TOPIC_FCM_CUSTOMER_NOTIFY=kafka.topic.fcm-customer-notify
      - KAFKA_TOPIC_EMPLOYEE_DEVICE_SYNC=kafka.topic.employee-device-sync
      - KAFKA_TOPIC_EMPLOYEE_PRIVILEGE_SYNC=kafka.topic.employee-privilege-sync
      - KAFKA_TOPIC_EMPLOYEE_ROLE_SYNC=kafka.topic.employee-role-sync
      - KAFKA_TOPIC_EMPLOYEE_NOTIFICATION_SYNC=kafka.topic.employee-notification-sync
      - KAFKA_TOPIC_CUSTOMER_BALANCE_TRANSACTION=kafka.topic.customer-balance-transaction
      - KAFKA_TOPIC_CUSTOMER_REGISTER_CONTACT=kafka.topic.customer-register-contact
      - KAFKA_TOPIC_SUPPLIER_ROLE_SYNC=kafka.topic.supplier-role-sync
      - KAFKA_TOPIC_BRANCH_SYNC=kafka.topic.branch-sync
      - KAFKA_TOPIC_AREA_SYNC=kafka.topic.area-sync
      - KAFKA_TOPIC_SUPPLIER_NOTIFICATION_SYNC=kafka.topic.supplier-notification-sync
      - KAFKA_TOPIC_EMPLOYEE_LOGOUT_PUSH_TOKEN_SYNC=kafka.topic.employee-logout-push-token-sync
      - KAFKA_TOPIC_ADMIN_CUSTOMER_BALANCE_TRANSACTION_SYNC=kafka.topic.admin-customer-balance-transaction-sync
      - KAFKA_TOPIC_ALO_POINT_BONUS_LEVEL_SYNC=kafka.topic.alo-point-bonus-level-sync
      - KAFKA_TOPIC_CUSTOMER_REVIEW_MAP_SYNC=kafka.topic.customer-review-map-sync
      - KAFKA_TOPIC_ZNS_BOOKING=kafka.topic.zns-booking
      - KAFKA_TOPIC_ADMIN_REGISTER_DEVICE=kafka.topic.admin-register-device
      - KAFKA_TOPIC_ADMIN_NOTIFY_HANDLER=kafka.topic.admin-notify-handler
      - KAFKA_TOPIC_BRANCH_RATING_SYNC=kafka.topic.branch-rating-sync
      - KAFKA_TOPIC_AREA_SYNC_NODEJS=kafka.topic.area-sync-nodejs
      - KAFKA_TOPIC_RESTAURANT_BRAND_SYNC_NODEJS=kafka.topic.restaurant-brand-sync-nodejs
      - KAFKA_TOPIC_BRANCH_SYNC_NODEJS=kafka.topic.branch-sync-nodejs
      - KAFKA_TOPIC_RESTAURNAT_SYNC_NODEJS=kafka.topic.restaurant-sync-nodejs
      - KAFKA_TOPIC_CUSTOMER_CHANGE_PASSWORD_PUSH_TOKEN_SYNC=kafka.topic.customer-change-password-push-token-sync
      - KAFKA_TOPIC_EMPLOYEE_SUPPLIER_CHANGE_PASSWORD_PUSH_TOKEN_SYNC=kafka.topic.employee-supplier-change-password-push-token-sync
      - KAFKA_TOPIC_EMPLOYEE_CHANGE_PASSWORD_PUSH_TOKEN_SYNC=kafka.topic.employee-change-password-push-token-sync
      - KAFKA_TOPIC_BLOCK_LOGIN_USER_ALOLINE=kafka.topic.block-login-user-aloline
      - KAFKA_TOPIC_ADMIN_ACTIVITY_LOG=kafka.topic.admin-activity-log
      - KAFKA_TOPIC_SUPPLIER_ACTIVITY_LOG=kafka.topic.supplier-activity-log
      - KAFKA_TOPIC_CUSTOMER_ACTIVITY_LOG=kafka.topic.customer-activity-log
      - KAFKA_TOPIC_FCM_KICK_OUT=kafka.topic.fcm-kick-out
      - KAFKA_TOPIC_CUSTOMER_ALO_POINT_SYNC=kafka.topic.customer-aloPoint-sync
      - KAFKA_TOPIC_EMPLOYEE_CREATE_SYNC_NODEJS=kafka.topic.employee-create-sync-nodejs
      - KAFKA_TOPIC_FAVORITE_BRAND_SYNC_NODEJS=kafka.topic.favorite-brand-sync-nodejs
      - KAFKA_TOPIC_SUPPLIER_EMPLOYEE_CREATE_SYNC_NODEJS=kafka.topic.supplier-employee-create-sync-nodejs
      - KAFKA_TOPIC_TECHRES_SALER_NOTIFICATION_SYNC=kafka.topic.techres-saler-notification-sync
      - KAFKA_TOPIC_INVOICE_SYNC=kafka.topic.invoice-sync
      - KAFKA_TOPIC_CUSTOMER_MEMBERSHIP_CARD_GIFT_SYNC=kafka.topic.customer-membership-card-gift-sync
      - KAFKA_TOPIC_CUSTOMER_MEMBERSHIP_CARD_SYNC=kafka.topic.customer-membership-card-sync
      - KAFKA_TOPIC_BEER_CONFIG_SYNC=kafka.topic.beer-gift-sync
      - KAFKA_TOPIC_BEER_GIFT_CONFIG_SYNC=kafka.topic.beer-gift-config-sync
      - KAFKA_TOPIC_RESTAURANT_CUSTOMER_MARKETING_NOTIFICATION_SYNC=kafka.topic.restaurant-customer-maketing-notification-sync
      - KAFKA_TOPIC_CLEAR_REPORT_CACHE_SYSTEM=kafka.topic.clear-report-cache-system
      - KAFKA_TOPIC_RESTAURANT_SCHEDULE_ORDER_EXPORTWAREHOUSEFROMFOODRECIPE=kafka.topic.restaurant-schedule-order-exportWarehouseFromFoodRecipe
      - KAFKA_TOPIC_RESTAURANT_SCHEDULE_ORDER_CREATEADDITIONFEEFORCOMPLETEDORDER=kafka.topic.restaurant-schedule-order-createAdditionFeeForCompletedOrder
      - KAFKA_TOPIC_RESTAURANT_SCHEDULE_ORDER_ADDBONUSCUSTOMERMEMBERSHIPPOINT=kafka.topic.restaurant-schedule-order-addBonusCustomerMembershipPoint
      - KAFKA_TOPIC_RESTAURANT_SCHEDULE_ORDER_ADDSALEPOINTFOREMPLOYEE=kafka.topic.restaurant-schedule-order-addSalePointForEmployee
      - KAFKA_TOPIC_RESTAURANT_SCHEDULE_ORDER_ADDCHEFFOODREVIEWSCORE=kafka.topic.restaurant-schedule-order-addChefFoodReviewScore
      - KAFKA_TOPIC_RESTAURANT_SCHEDULE_ORDER_COMPLETEBOOKING=kafka.topic.restaurant-schedule-order-completeBooking
      - KAFKA_TOPIC_CLEAR_REPORT_CACHE_SYSTEM_BY_RESTAURANT_RESOURCE=kafka.topic.clear-report-cache-system-by-restaurant-resource
      - KAFKA_TOPIC_ALOLINE_TAG_SYNC=kafka.topic.aloline-tag-sync
      - KAFKA_TOPIC_DELETE_ACCOUNT_SYNC=kafka.topic.delete-account-sync
      - KAFKA_TOPIC_REGISTER_MEMBERSHIP_CARD_SYNC=kafka.topic.register-membership-card-sync
      - KAFKA_TOPIC_CUSTOMER_GIFTS_SYNC=kafka.topic.customer-gifts-sync
      - KAFKA_TOPIC_EMPLOYEE_ROLE_NOTIFICATION_SYNC=kafka.topic.employee-role-notification-sync
      - KAFKA_TOPIC_RESTAURANT_SCHEDULE_ORDER_RESTAURANTGREETINGNOTIFICATION=kafka.topic.restaurant-schedule-order-restaurantGreetingNotification
      - KAFKA_TOPIC_RESTAURANT_SCHEDULE_ORDER_EXPORTWAREHOUSEFROMFOODRECIPEGROUPTIME=kafka.topic.restaurant-schedule-order-exportWarehouseFromFoodRecipeGroupTime
      - KAFKA_TOPIC_RESTAURANT_SYNC_FANOUT=kafka.topic.restaurant-sync-fanout
      - KAFKA_TOPIC_TECHRES_MAINTENANCE_NOTIFICATION=kafka.topic.techres-maintenance-notification
      - KAFKA_TOPIC_RESTAURANT_SCHEDULE_ORDER_PROCESSEXPORTWAREHOUSEFROMFOODRECIPE=kafka.topic.restaurant-schedule-order-processExportWarehouseFromFoodRecipe
      - KAFKA_TOPIC_RESTAURANT_SCHEDULE_ORDER_PROCESSCREATEADDITIONFEEFORCOMPLETEDORDER=kafka.topic.restaurant-schedule-order-processCreateAdditionFeeForCompletedOrder
      - KAFKA_TOPIC_RESTAURANT_SCHEDULE_ORDER_PROCESSCCOMPLETEBOOKING=kafka.topic.restaurant-schedule-order-processCompleteBooking
      - KAFKA_TOPIC_RESTAURANT_SCHEDULE_ORDER_PROCESSADDBONUSCUSTOMERMEMBERSHIPPOINT=kafka.topic.restaurant-schedule-order-processAddBonusCustomerMembershipPoint
      - KAFKA_TOPIC_RESTAURANT_SCHEDULE_ORDER_PROCESSADDSALEPOINTFOREMPLOYEE=kafka.topic.restaurant-schedule-order-processAddSalePointForEmployee
      - KAFKA_TOPIC_RESTAURANT_SCHEDULE_ORDER_PROCESSADDCHEFFOODREVIEWSCORE=kafka.topic.restaurant-schedule-order-processAddChefFoodReviewScore
      - KAFKA_TOPIC_RESTAURANT_SCHEDULE_ORDER_PROCESSCOMPLETEBOOKING=kafka.topic.restaurant-schedule-order-processCompleteBooking
      - KAFKA_TOPIC_RESTAURANT_SCHEDULE_ORDER_PROCESSRESTAURANTGREETINGNOTIFICATION=kafka.topic.restaurant-schedule-order-processRestaurantGreetingNotification
      - KAFKA_TOPIC_RESTAURANT_SCHEDULE_ORDER_PROCESSEXPORTWAREHOUSEFROMFOODRECIPEGROUPTIME=kafka.topic.restaurant-schedule-order-processExportWarehouseFromFoodRecipeGroupTime
      - KAFKA_TOPIC_ADVISER_REGISTER_DEVICE=kafka.topic.adviser-register-device
      - KAFKA_TOPIC_NOTIFY_ADVISER=kafka.topic.notify_adviser
      - KAFKA_TECHRES_NOTIFICATION=kafka.techres-notification
      - KAFKA_TOPIC_UPDATE_RESET_PC_BEER_GIFT_DATE_SYNC=kafka.topic.update-reset-pc-beer-gift-date-sync
      - KAFKA_TOPIC_RESTAURANT_CUSTOMER_MARKETING_NOTIFICATION_SYNC=kafka.topic.restaurant-customer-marketing-notification-sync
      - FIREBASE_TOPIC_NOTIFY_BEER_GIFT_DAILY=staging_topic_notify_beer_gift_daily
      - CONFIG_IS_ENABLE_TOPUP_CARD=1

# ----------------------------------------------------
# NETWORK BLOCK (Cùng cấp với 'services')
# ----------------------------------------------------
networks:
  techres_overlay:
    driver: overlay
    attachable: true
